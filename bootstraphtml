<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bootstrap Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.js"></script>  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">  
  
  <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/js/bootstrap-multiselect.js"></script>  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/css/bootstrap-multiselect.css"> 
  <style>
	#cover-spin {
		position:fixed;
		width:100%;
		left:0;right:0;top:0;bottom:0;
		background-color: rgba(255,255,255,0.7);
		z-index:9999;   
		display: none;
	}
	@-webkit-keyframes spin {
		from {-webkit-transform:rotate(0deg);}
		to {-webkit-transform:rotate(360deg);}
	}
	@keyframes spin {
		from {transform:rotate(0deg);}
		to {transform:rotate(360deg);}
	}
	#cover-spin::after {
		content:'';
		display:block;
		position:absolute;
		left:48%;top:40%;
		width:70px;height:70px;
		border-style:solid;
		border-color:green;
		border-top-color:transparent;
		border-width: 4px;
		border-radius:50%;
		-webkit-animation: spin .8s linear infinite;
		animation: spin .8s linear infinite;
	}
	
	
	
</style>
  <script>
	$(document).ready(function(){
	    $('[data-toggle="popover"]').popover();

		$("#validateForm").hide();
		$(".monitorData").hide();
		
		$("#frmAction").on("submit", function(event){
			event.preventDefault();
			$(".monitorData").hide();
			$("#cover-spin").show();
			//$("#multiple-checkboxes").multiselect("clearSelection");
			var formValues= $(this).serialize();
			var actionUrl = 'http://localhost:3000/api/postdata';
			$("#multiple-checkboxes").empty();
			$.post(actionUrl, formValues, function(data){
				$("#cover-spin").hide();
				// Display the returned data in browser
				$("#validateForm").show();
				var multipleCheckBoxes= '<select multiple="multiple" id="validationDropdown" name="multiselect[]"> ';
				$.each(data, function(val, text) {
					multipleCheckBoxes+= '<option value="'+val+'">'+text+'</option>';
				});
				multipleCheckBoxes+= '</select>';
				$("#multiple-checkboxes").append(multipleCheckBoxes);
				$('#validationDropdown').multiselect();
			
			});
		});
		
		$("#validateForm").on("submit", function(event){
			event.preventDefault();
			$("#data-body").empty();
			$("#data-body2").empty();
			$("#data-body3").empty();
			
			var formValues= $("#validationDropdown").val();
			var arrayData = "";
			for(var i = 0; i < formValues.length; i++){
			arrayData+= formValues[i]+',';
			}
			console.log(arrayData);
			var actionUrl = 'http://localhost:3000/api/postdata';
	 
			$.post(actionUrl, {'data':arrayData}, function(data1){
				// Display the returned data in browser
				
				$(".monitorData").show();		
				var data = {
						"data1":
								  [
									{
										id: 1,
										name: 'Item 1',
										price: '100'
									}, {
										id: 2,
										name: 'Item 2',
										price: null
									}
								  ],
						"data2":
								  [
									{
										id: 1,
										name: 'data 2 Item 1',
										price: null
									}, {
										id: 2,
										name: 'data 2 Item 2',
										price: '200'
									}
								  ],
						"data3":
								  [
									{
										id: 1,
										name: 'data 3 Item 1',
										price: '100'
									}, {
										id: 2,
										name: 'data 3 Item 2',
										price: '200'
									}
								  ]
			  
					}
				for(var i=0;i<data.data1.length;i++)
				{
					var tr="<tr>";
					var td1="<td>"+data.data1[i]["id"]+"</td>";
					var td2="<td>"+data.data1[i]["name"]+"</td>";
					var td3="<td>"+data.data1[i]["price"]+"</td></tr>";
					if(data.data1[i]["price"] === null || data.data1[i]["price"]==="")
					{
						$("#price").css("color", "red");
					}
				   $("#data-body").append(tr+td1+td2+td3); 
				}  
				for(var i=0;i<data.data2.length;i++)
				{
					var tr="<tr>";
					var td1="<td>"+data.data2[i]["id"]+"</td>";
					var td2="<td>"+data.data2[i]["name"]+"</td>";
					var td3="<td>"+data.data2[i]["price"]+"</td></tr>";
				   $("#data-body2").append(tr+td1+td2+td3); 
				}  
				for(var i=0;i<data.data3.length;i++)
				{
					var tr="<tr>";
					var td1="<td>"+data.data3[i]["id"]+"</td>";
					var td2="<td>"+data.data3[i]["name"]+"</td>";
					var td3="<td>"+data.data3[i]["price"]+"</td></tr>";
				   $("#data-body3").append(tr+td1+td2+td3); 
				}  
			
			
			});
		});
	});
</script>
</head>
<body>
<!-- Wrapper container -->
<div id="cover-spin"></div>

<div class="container">

  <form id="frmAction" class="form-group" style="margin-top:10%;">
    <div class="col-md-3 md-4">
		<select id="mySelect"  name="singleoption" >
			<option  value="1">Option one</option>
			<option  value="2">Option two</option>
			<option  value="3">Option three</option>
		</select>
    </div>
    <div class="d-grid">
      <button class="btn btn-primary btn-md" type="submit"  data-placement="top"  data-toggle="popover" data-content="Some content inside the popover">Submit</button>
	  <button class="btn btn-primary btn-md" type="submit">Refresh</button>
    </div>
  </form>
  
    
  <form id="validateForm" class="form-group" name="validationForm">
	<!-- Email address input -->
    <div class="col-md-3 md-4" id="multiple-checkboxes" >
      
	</div>	
	<div class="d-grid">
      <button class="btn btn-primary btn-md" type="submit">Validate</button>
    </div>
	</form>
	<table class="table table-bordered monitorData">
  <thead class="thead-dark" style="background-color:#80808026; font-size: larger;">
    <tr>
      <th scope="col">SNO</th>
      <th scope="col">Name</th>
      <th scope="col" id="price">Price</th>
    </tr>
  </thead>
  <tbody id="data-body">
   
  </tbody>
</table>
<table class="table table-bordered monitorData">
  <thead class="thead-dark" style="background-color:#80808026; font-size: larger;">
    <tr>
      <th scope="col">SNO</th>
      <th scope="col">Name</th>
      <th scope="col">Price</th>
    </tr>
  </thead>
  <tbody id="data-body2">
   
  </tbody>
</table>
<table class="table table-bordered monitorData">
  <thead class="thead-dark" style="background-color:#80808026; font-size: larger;">
    <tr>
      <th scope="col">SNO</th>
      <th scope="col">Name</th>
      <th scope="col">Price</th>
    </tr>
  </thead>
  <tbody id="data-body3">
   
  </tbody>
</table>
</div>


</body>
</html>
